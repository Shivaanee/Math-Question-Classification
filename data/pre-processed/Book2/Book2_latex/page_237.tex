Example.We consider the least squares problem with data

\[A=\left[\begin{array}{cc}2&0\\ -1&1\\ 0&2\end{array}\right],\qquad b=\left[\begin{array}{c}1\\ 0\\ -1\end{array}\right].\]

The over-determined set of three equations in two variables \(Ax=b\),

\[2x_{1}=1,\qquad-x_{1}+x_{2}=0,\qquad 2x_{2}=-1,\]

has no solution. (From the first equation we have \(x_{1}=1/2\), and from the last equation we have \(x_{2}=-1/2\); but then the second equation does not hold.) The corresponding least squares problem is

\[\mbox{minimize}\quad(2x_{1}-1)^{2}+(-x_{1}+x_{2})^{2}+(2x_{2}+1)^{2}.\]

This least squares problem can be solved using the methods described in the next section (or simple calculus). Its unique solution is \(\hat{x}=(1/3,-1/3)\). The least squares approximate solution \(\hat{x}\) does not satisfy the equations \(Ax=b\); the corresponding residuals are

\[\hat{r}=A\hat{x}-b=(-1/3,-2/3,1/3),\]

with sum of squares value \(\|A\hat{x}-b\|^{2}=2/3\). Let us compare this to another choice of \(x\), \(\tilde{x}=(1/2,-1/2)\), which corresponds to (exactly) solving the first and last of the three equations in \(Ax=b\). It gives the residual

\[\tilde{r}=A\tilde{x}-b=(0,-1,0),\]

with sum of squares value \(\|A\tilde{x}-b\|^{2}=1\).

The column interpretation tells us that

\[(1/3)\left[\begin{array}{c}2\\ -1\\ 0\end{array}\right]+(-1/3)\left[\begin{array}{c}0\\ 1\\ 2\end{array}\right]=\left[\begin{array}{c}2/3\\ -2/3\\ -2/3\end{array}\right]\]

is the linear combination of the columns of \(A\) that is closest to \(b\).

Figure 12.1 shows the values of the least squares objective \(\|Ax-b\|^{2}\) versus \(x=(x_{1},x_{2})\), with the least squares solution \(\hat{x}\) shown as the dark point, with objective value \(\|A\hat{x}-b\|^{2}=2/3\). The curves show the points \(x\) that have objective value \(\|A\hat{x}-b\|^{2}+1\), \(\|A\hat{x}-b\|^{2}+2\), and so on.

### 12.2 Solution

In this section we derive several expressions for the solution of the least squares problem (12.1), under one assumption on the data matrix \(A\):

_The columns of \(A\) are linearly independent._ (12.2) 