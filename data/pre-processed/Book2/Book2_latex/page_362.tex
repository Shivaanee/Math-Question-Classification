

## 16 Constrained least squares

### 16.1 Smallest right inverse

Suppose the \(m\times n\) matrix \(A\) is wide, with linearly independent rows. Its pseudo-inverse \(A^{\dagger}\) is a right inverse of \(A\). In fact, there are many right inverses of \(A\) and it turns out that \(A^{\dagger}\) is the smallest one among them, as measured by the matrix norm. In other words, if \(X\) satisfies \(AX=I\), then \(\|X\|\geq\|A^{\dagger}\|\). You will show this in this problem.

1. Suppose \(AX=I\), and let \(x_{1},\ldots,x_{m}\) denote the columns of \(X\). Let \(b_{j}\) denote the \(j\)th column of \(A^{\dagger}\). Explain why \(\|x_{j}\|^{2}\geq\|b_{j}\|^{2}\). _Hint_. Show that \(z=b_{j}\) is the vector of smallest norm that satisfies \(Az=e_{j}\), for \(j=1,\ldots,m\).
2. Use the inequalities from part (a) to establish \(\|X\|\geq\|A^{\dagger}\|\).
3. _Matrix least norm problem_. The matrix least norm problem is minimize \[\|X\|^{2}\] subject to \[CX=D,\] where the variable to be chosen is the \(n\times k\) matrix \(X\); the \(p\times n\) matrix \(C\) and the \(p\times k\) matrix \(D\) are given. Show that the solution of this problem is \(\hat{X}=C^{\dagger}D\), assuming the rows of \(C\) are linearly independent. _Hint_. Show that we can find the columns of \(X\) independently, by solving a least norm problem for each one.
4. _Closest solution to a given point_. Suppose the wide matrix \(A\) has linearly independent rows. Find an expression for the point \(x\) that is closest to a given vector \(y\) (_i.e._, minimizes \(\|x-y\|^{2}\)) among all vectors that satisfy \(Ax=b\). _Remark_. This problem comes up when \(x\) is some set of inputs to be found, \(Ax=b\) represents some set of requirements, and \(y\) is some nominal value of the inputs. For example, when the inputs represent actions that are re-calculated each day (say, because \(b\) changes every day), \(y\) might be yesterday's action, and the today's action \(x\) found as above gives the least change from yesterday's action, subject to meeting today's requirements.
5. _Nearest vector with a given average_. Let \(a\) be an \(n\)-vector and \(\beta\) a scalar. How would you find the \(n\)-vector \(x\) that is closest to \(a\) among all \(n\)-vectors that have average value \(\beta\)? Give a formula for \(x\) and describe it in English.
6. _Checking constrained least squares solution_. Generate a random \(20\times 10\) matrix \(A\) and a random \(5\times 10\) matrix \(C\). Then generate random vectors \(b\) and \(d\) of appropriate dimensions for the constrained least squares problem minimize \[\|Ax-b\|^{2}\] subject to \[Cx=d.\] Compute the solution \(\hat{x}\) by forming and solving the KKT equations. Verify that the constraints very nearly hold, _i.e._, \(C\hat{x}-d\) is very small. Find the least norm solution \(x^{\mathrm{ln}}\) of \(Cx=d\). The vector \(x^{\mathrm{ln}}\) also satisfies \(Cx=d\) (very nearly). Verify that \(\|Ax^{\mathrm{ln}}-b\|^{2}>\|A\hat{x}-b\|^{2}\).
7. _Modifying a diet to meet nutrient requirements_. (Continuation of exercise 8.9.) The current daily diet is specified by the \(n\)-vector \(d^{\mathrm{curr}}\). Explain how to find the closest diet \(d^{\mathrm{nod}}\) to \(d^{\mathrm{curr}}\) that satisfies the nutrient requirements given by the \(m\)-vector \(n^{\mathrm{des}}\), and has the same cost as the current diet \(d^{\mathrm{curr}}\).
8. _Minimum cost trading to achieve target sector exposures_. A current portfolio is given by the \(n\)-vector \(h^{\mathrm{curr}}\), with the entries giving the dollar value invested in the \(n\) assets. The total value (or net asset value) of the portfolio is \(\mathbf{1}^{T}h^{\mathrm{curr}}\). We seek a new portfolio, given by the \(n\)-vector \(h\), with the same total value as \(h^{\mathrm{curr}}\). The difference \(h-h^{\mathrm{curr}}\) is called the _trade vector_; it gives the amount of each asset (in dollars) that we buy or sell. The \(n\) assets are divided into \(m\) industry sectors, such as pharmaceuticals or consumer